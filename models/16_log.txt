Using device: cuda
Loading dataset: 100% 107620/107620 [01:27<00:00, 1233.65it/s]
Loading dataset: 100% 3771/3771 [00:02<00:00, 1288.60it/s]
Loading model checkpoint from /content/iam_handwritten/models/14_sameas13_and_augmentation_7.89.pth...
✅ Loaded 18 layers from checkpoint.
❌ Skipped 6 incompatible layers.
Training for ∞ epochs...
============================================================
Epoch 1/∞
Training Loss: 2.6316
Validation CER: 0.3767
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 2/∞
Training Loss: 1.5772
Validation CER: 0.1743
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 3/∞
Training Loss: 1.0890
Validation CER: 0.1228
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 4/∞
Training Loss: 0.8832
Validation CER: 0.0975
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 5/∞
Training Loss: 0.7858
Validation CER: 0.0869
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 6/∞
Training Loss: 0.7257
Validation CER: 0.0865
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 7/∞
Training Loss: 0.6801
Validation CER: 0.0840
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 8/∞
Training Loss: 0.6504
Validation CER: 0.0814
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 9/∞
Training Loss: 0.6269
Validation CER: 0.0774
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 10/∞
Training Loss: 0.6050
Validation CER: 0.0767
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 11/∞
Training Loss: 0.5950
Validation CER: 0.0768
Learning Rate: 0.001000
============================================================
No improvement. Patience: 1/10
============================================================
Epoch 12/∞
Training Loss: 0.5750
Validation CER: 0.0747
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 13/∞
Training Loss: 0.5631
Validation CER: 0.0712
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 14/∞
Training Loss: 0.5469
Validation CER: 0.0700
Learning Rate: 0.001000
============================================================
New best model saved.
============================================================
Epoch 15/∞
Training Loss: 0.5352
Validation CER: 0.0724
Learning Rate: 0.001000
============================================================
No improvement. Patience: 1/10
============================================================
Epoch 16/∞
Training Loss: 0.5285
Validation CER: 0.0731
Learning Rate: 0.001000
============================================================
No improvement. Patience: 2/10
============================================================
Epoch 17/∞
Training Loss: 0.5180
Validation CER: 0.0743
Learning Rate: 0.001000
============================================================
No improvement. Patience: 3/10
============================================================
Epoch 18/∞
Training Loss: 0.4616
Validation CER: 0.0682
Learning Rate: 0.000500
============================================================
New best model saved.
============================================================
Epoch 19/∞
Training Loss: 0.4404
Validation CER: 0.0667
Learning Rate: 0.000500
============================================================
New best model saved.
============================================================
Epoch 20/∞
Training Loss: 0.4305
Validation CER: 0.0706
Learning Rate: 0.000500
============================================================
No improvement. Patience: 1/10
============================================================
Epoch 21/∞
Training Loss: 0.4227
Validation CER: 0.0682
Learning Rate: 0.000500
============================================================
No improvement. Patience: 2/10
============================================================
Epoch 22/∞
Training Loss: 0.4129
Validation CER: 0.0639
Learning Rate: 0.000500
============================================================
New best model saved.
============================================================
Epoch 23/∞
Training Loss: 0.4135
Validation CER: 0.0664
Learning Rate: 0.000500
============================================================
No improvement. Patience: 1/10
============================================================
Epoch 24/∞
Training Loss: 0.4053
Validation CER: 0.0669
Learning Rate: 0.000500
============================================================
No improvement. Patience: 2/10
============================================================
Epoch 25/∞
Training Loss: 0.4021
Validation CER: 0.0650
Learning Rate: 0.000500
============================================================
No improvement. Patience: 3/10
============================================================
Epoch 26/∞
Training Loss: 0.3789
Validation CER: 0.0636
Learning Rate: 0.000250
============================================================
New best model saved.
============================================================
Epoch 27/∞
Training Loss: 0.3655
Validation CER: 0.0665
Learning Rate: 0.000250
============================================================
No improvement. Patience: 1/10
============================================================
Epoch 28/∞
Training Loss: 0.3597
Validation CER: 0.0642
Learning Rate: 0.000250
============================================================
No improvement. Patience: 2/10
============================================================
Epoch 29/∞
Training Loss: 0.3585
Validation CER: 0.0670
Learning Rate: 0.000250
============================================================
No improvement. Patience: 3/10
============================================================
Epoch 30/∞
Training Loss: 0.3486
Validation CER: 0.0659
Learning Rate: 0.000125
============================================================
No improvement. Patience: 4/10
============================================================
Epoch 31/∞
Training Loss: 0.3400
Validation CER: 0.0650
Learning Rate: 0.000125
============================================================
No improvement. Patience: 5/10
============================================================
Epoch 32/∞
Training Loss: 0.3409
Validation CER: 0.0647
Learning Rate: 0.000125
============================================================
No improvement. Patience: 6/10
============================================================
Epoch 33/∞
Training Loss: 0.3383
Validation CER: 0.0637
Learning Rate: 0.000063
============================================================
No improvement. Patience: 7/10
============================================================
Epoch 34/∞
Training Loss: 0.3303
Validation CER: 0.0629
Learning Rate: 0.000063
============================================================
New best model saved.
============================================================
Epoch 35/∞
Training Loss: 0.3288
Validation CER: 0.0638
Learning Rate: 0.000063
============================================================
No improvement. Patience: 1/10
============================================================
Epoch 36/∞
Training Loss: 0.3266
Validation CER: 0.0625
Learning Rate: 0.000063
============================================================
New best model saved.
============================================================
Epoch 37/∞
Training Loss: 0.3274
Validation CER: 0.0637
Learning Rate: 0.000063
============================================================
No improvement. Patience: 1/10
============================================================
Epoch 38/∞
Training Loss: 0.3242
Validation CER: 0.0626
Learning Rate: 0.000063
============================================================
No improvement. Patience: 2/10
============================================================
Epoch 39/∞
Training Loss: 0.3226
Validation CER: 0.0630
Learning Rate: 0.000063
============================================================
No improvement. Patience: 3/10
============================================================
Epoch 40/∞
Training Loss: 0.3228
Validation CER: 0.0624
Learning Rate: 0.000031
============================================================
New best model saved.
============================================================
Epoch 41/∞
Training Loss: 0.3218
Validation CER: 0.0635
Learning Rate: 0.000031
============================================================
No improvement. Patience: 1/10
============================================================
Epoch 42/∞
Training Loss: 0.3185
Validation CER: 0.0627
Learning Rate: 0.000031
============================================================
No improvement. Patience: 2/10
============================================================
Epoch 43/∞
Training Loss: 0.3177
Validation CER: 0.0628
Learning Rate: 0.000031
============================================================
No improvement. Patience: 3/10
============================================================
Epoch 44/∞
Training Loss: 0.3170
Validation CER: 0.0622
Learning Rate: 0.000016
============================================================
New best model saved.
============================================================
Epoch 45/∞
Training Loss: 0.3176
Validation CER: 0.0625
Learning Rate: 0.000016
============================================================
No improvement. Patience: 1/10
============================================================
Epoch 46/∞
Training Loss: 0.3167
Validation CER: 0.0625
Learning Rate: 0.000016
============================================================
No improvement. Patience: 2/10
============================================================
Epoch 47/∞
Training Loss: 0.3159
Validation CER: 0.0622
Learning Rate: 0.000016
============================================================
New best model saved.
============================================================
Epoch 48/∞
Training Loss: 0.3175
Validation CER: 0.0624
Learning Rate: 0.000016
============================================================
No improvement. Patience: 1/10
============================================================
Epoch 49/∞
Training Loss: 0.3139
Validation CER: 0.0620
Learning Rate: 0.000016
============================================================
New best model saved.
============================================================
Epoch 50/∞
Training Loss: 0.3143
Validation CER: 0.0615
Learning Rate: 0.000016
============================================================
New best model saved.
============================================================
Epoch 51/∞
Training Loss: 0.3146
Validation CER: 0.0623
Learning Rate: 0.000016
============================================================
No improvement. Patience: 1/10
============================================================
Epoch 52/∞
Training Loss: 0.3157
Validation CER: 0.0616
Learning Rate: 0.000016
============================================================
No improvement. Patience: 2/10
============================================================
Epoch 53/∞
Training Loss: 0.3168
Validation CER: 0.0631
Learning Rate: 0.000016
============================================================
No improvement. Patience: 3/10
============================================================
Epoch 54/∞
Training Loss: 0.3148
Validation CER: 0.0631
Learning Rate: 0.000008
============================================================
No improvement. Patience: 4/10
============================================================
Epoch 55/∞
Training Loss: 0.3155
Validation CER: 0.0628
Learning Rate: 0.000008
============================================================
No improvement. Patience: 5/10
============================================================
Epoch 56/∞
Training Loss: 0.3149
Validation CER: 0.0626
Learning Rate: 0.000008
============================================================
No improvement. Patience: 6/10
============================================================
Epoch 57/∞
Training Loss: 0.3129
Validation CER: 0.0628
Learning Rate: 0.000004
============================================================
No improvement. Patience: 7/10
============================================================
Epoch 58/∞
Training Loss: 0.3092
Validation CER: 0.0625
Learning Rate: 0.000004
============================================================
No improvement. Patience: 8/10
============================================================
Epoch 59/∞
Training Loss: 0.3099
Validation CER: 0.0621
Learning Rate: 0.000004
============================================================
No improvement. Patience: 9/10
============================================================
Epoch 60/∞
Training Loss: 0.3099
Validation CER: 0.0620
Learning Rate: 0.000002
============================================================
No improvement. Patience: 10/10
Early stopping triggered.